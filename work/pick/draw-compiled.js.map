{"version":3,"sources":["draw.js"],"names":[],"mappings":"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","file":"draw-compiled.js","sourcesContent":["function Draw(cobj, setting) {\r\n    this.cobj = cobj;\r\n    this.type = setting.type || \"stroke\";\r\n    this.color = setting.color || \"#000\";\r\n    this.width = setting.width || \"1\";\r\n    this.poly = setting.poly || 3;\r\n}\r\nDraw.prototype = {\r\n    init: function () {\r\n        this.cobj.strokeStyle = this.color;\r\n        this.cobj.fillStyle = this.color;\r\n        this.cobj.lineWidth = this.width;\r\n        this.cobj.poly = this.poly;\r\n    },\r\n    rect: function (x, y, x1, y1) {\r\n        this.init();\r\n        this.cobj.beginPath();\r\n        this.cobj.rect(x, y, x1 - x, y1 - y);\r\n        if (this.type == \"stroke\") {\r\n            this.cobj.stroke();\r\n        } else {\r\n            this.cobj.fill();\r\n        }\r\n    },\r\n    circle: function (x, y, x1, y1) {\r\n        var r = Math.sqrt((x1 - x) * (x1 - x) - (y1 - y) * (y1 - y));\r\n        this.init();\r\n        this.cobj.beginPath();\r\n        this.cobj.arc(x, y, r, 0, Math.PI * 2, true)\r\n        if (this.type == \"stroke\") {\r\n            this.cobj.stroke();\r\n        } else {\r\n            this.cobj.fill();\r\n        }\r\n    },\r\n    line: function (x, y, x1, y1) {\r\n        this.init();\r\n        this.cobj.beginPath();\r\n        this.cobj.moveTo(x, y);\r\n        this.cobj.lineTo(x1, y1);\r\n        if (this.type == \"stroke\") {\r\n            this.cobj.stroke();\r\n        } else {\r\n            this.cobj.fill();\r\n        }\r\n    },\r\n    polygon: function (x, y, x1, y1) {\r\n        var cobj = this.cobj, poly = this.poly;\r\n        var r = Math.sqrt((x1 - x) * (x1 - x) - (y1 - y) * (y1 - y));\r\n        var px = Math.cos(Math.PI / poly) * r,\r\n            py = Math.sin(Math.PI / poly) * r;\r\n        this.init();\r\n        //console.log(poly);\r\n        cobj.beginPath();\r\n        for (i = 0; i < poly; i++) {\r\n            cobj.save();\r\n            cobj.translate(x, y);\r\n            cobj.rotate(i * 2 / poly * Math.PI + 90 * Math.PI / 180);\r\n            cobj.moveTo(px, py);\r\n            cobj.lineTo(px, -py);\r\n            cobj.stroke();\r\n            cobj.restore();\r\n            console.log(poly);\r\n        }\r\n        cobj.restore();\r\n    },\r\n    pencil: function (x, y, x1, y1) {\r\n        this.init();\r\n        var cobj = this.cobj;\r\n        // cobj.beginPath();\r\n        // cobj.moveTo(x1,y1);\r\n        cobj.lineTo(x1, y1);\r\n        cobj.stroke();\r\n        cobj.restore();\r\n    },\r\n    eraser: function (x, y, x1, y1) {\r\n        this.init();\r\n        var cobj = this.cobj;\r\n        // cobj.moveTo(x,y);\r\n        cobj.clearRect(x1, y1, 20, 20);\r\n        cobj.save();\r\n    },\r\n    cut: function (x, y, x1, y1) {\r\n        var cobj = this.cobj;\r\n        cobj.save();\r\n        cobj.lineWidth = 1;\r\n        cobj.strokeStyle = \"#999\";\r\n        cobj.setLineDash([4, 2]);\r\n        cobj.strokeRect(x, y, x1 - x, y1 - y);\r\n        cobj.restore();\r\n    },\r\n    copy: function (x, y, x1, y1) {\r\n        var cobj = this.cobj;\r\n        cobj.save();\r\n        cobj.lineWidth = 1;\r\n        cobj.strokeStyle = \"#999\";\r\n        cobj.setLineDash([4, 2]);\r\n        cobj.strokeRect(x, y, x1 - x, y1 - y);\r\n        cobj.restore();\r\n    }\r\n}\r\nvar cutflag = false;\r\nvar cutdata;\r\nvar ex, ey, ow, oh;\r\nvar arr = [];\r\nvar lex, ley, low, loh;\r\nvar step = 0;\r\nvar canvas = document.querySelector(\"canvas\");\r\ncanvas.onmousedown = function (e) {\r\n    ex = e.offsetX;\r\n    ey = e.offsetY;\r\n    var draw = new Draw(cobj, {color: newcolor, type: type1, width: size});\r\n    if (type == \"pen\") {\r\n        cobj.beginPath();\r\n        cobj.moveTo(ex, ey);\r\n    }\r\n    if (copy.checked == true && step == 1) {\r\n        arr.pop();\r\n    }\r\n    canvas.onmousemove = function (e) {\r\n        ow = e.offsetX;\r\n        oh = e.offsetY;\r\n        if (type != \"eraser\") {\r\n            cobj.clearRect(0, 0, 800, 600);\r\n            if (arr.length != 0) {\r\n                cobj.putImageData(arr[arr.length - 1], 0, 0, 0, 0, 800, 600);\r\n            }\r\n        }\r\n        if (step == 1 && type == \"cut\") {\r\n            if (copy.checked == false) {\r\n                cobj.clearRect(lex - 1, ley - 1, low - lex + 2, loh - ley + 2)\r\n            }\r\n            var nx = lex + ow - ex;\r\n            var ny = ley + oh - ey;\r\n            if (iscopy) {\r\n                cobj.putImageData(arr[arr.length - 2], 0, 0, 0, 0, 800, 600);\r\n            } else {\r\n                cobj.putImageData(cutdata, nx, ny);\r\n            }\r\n        } else if (type == \"poly\") {\r\n            draw[type](ex, ey, ow, oh, num);\r\n        } else {\r\n            draw[type](ex, ey, ow, oh);\r\n        }\r\n    };\r\n    canvas.onmouseup = function () {\r\n        canvas.onmousemove = null;\r\n        canvas.onmouseup = null;\r\n        if (type == \"cut\") {\r\n            if (step == 0) {\r\n                step = 1;\r\n                cutdata = cobj.getImageData(ex + 1, ey + 1, ow - ex - 2, oh - ey - 2);\r\n                lex = ex;\r\n                ley = ey;\r\n                low = ow;\r\n                loh = oh;\r\n//                    contral.style.display=\"none\";\r\n            } else if (step == 1 && type == \"cut\") {\r\n                step = 0;\r\n//                   contral.style.display=\"flex\";\r\n            }\r\n        }\r\n        arr.push(cobj.getImageData(0, 0, 800, 600));\r\n    }\r\n}\r\n//新建\r\ndocument.querySelector(\".new\").onclick = function () {\r\n    cobj.clearRect(0, 0, 800, 600);\r\n    var arr = [];\r\n    newk = canvas.width = prompt(\"宽\", \"\");\r\n    newg = canvas.height = prompt(\"高\", \"\");\r\n};\r\ndocument.querySelector('.back').onclick = function () {\r\n    arr.pop();\r\n    cobj.clearRect(0, 0, 800, 600);\r\n    cobj.putImageData(arr[arr.length - 1], 0, 0, 0, 0, 800, 600);\r\n}\r\ndocument.querySelector('.save').onclick = function () {\r\n    alert(1)\r\n//        var res=canvas.toDataURL(\"image/png\");\r\n//        location.href=res;\r\n    location.href = canvas.toDataURL(\"image/png\").replace(\"image/png\", \"image/octet-stream\")\r\n}\r\ndocument.querySelector('.kong').onclick = function () {\r\n    cobj.clearRect(0, 0, 800, 600);\r\n    arr = [];\r\n}"]}